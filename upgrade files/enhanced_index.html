<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advanced Crypto Airdrop Compass</title>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- Mobile App Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="AirdropCompass">
  <meta name="theme-color" content="#8b5cf6" id="theme-color-meta">
  <meta name="msapplication-TileColor" content="#8b5cf6">
  
  <!-- SEO Meta Tags -->
  <meta name="description" content="Advanced Crypto Airdrop Compass - Track, manage, and strategize crypto airdrops with AI-powered insights">
  <meta name="keywords" content="crypto, airdrop, DeFi, blockchain, portfolio, tracking">
  <meta name="author" content="MiniMax Agent">
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Advanced Crypto Airdrop Compass">
  <meta property="og:description" content="Track, manage, and strategize crypto airdrops with AI-powered insights">
  <meta property="og:type" content="website">
  <meta property="og:url" content="">
  <meta property="og:image" content="/assets/og-image.png">
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Advanced Crypto Airdrop Compass">
  <meta name="twitter:description" content="Track, manage, and strategize crypto airdrops with AI-powered insights">
  <meta name="twitter:image" content="/assets/twitter-image.png">
  
  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  <!-- Font Preloads -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  
  <!-- Enhanced Font Loading -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet" id="main-font-link">
  
  <!-- Tailwind CSS with Enhanced Configuration -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: {
              50: 'rgb(var(--color-primary-50) / <alpha-value>)',
              100: 'rgb(var(--color-primary-100) / <alpha-value>)',
              200: 'rgb(var(--color-primary-200) / <alpha-value>)',
              300: 'rgb(var(--color-primary-300) / <alpha-value>)',
              400: 'rgb(var(--color-primary-400) / <alpha-value>)',
              500: 'rgb(var(--color-primary-500) / <alpha-value>)',
              600: 'rgb(var(--color-primary-600) / <alpha-value>)',
              700: 'rgb(var(--color-primary-700) / <alpha-value>)',
              800: 'rgb(var(--color-primary-800) / <alpha-value>)',
              900: 'rgb(var(--color-primary-900) / <alpha-value>)',
              950: 'rgb(var(--color-primary-950) / <alpha-value>)',
              DEFAULT: 'rgb(var(--color-primary-500) / <alpha-value>)'
            },
            gray: {
              50: '#f8fafc',
              100: '#f1f5f9',
              200: '#e2e8f0',
              300: '#cbd5e1',
              400: '#94a3b8',
              500: '#64748b',
              600: '#475569',
              700: '#334155',
              800: '#1e293b',
              900: '#0f172a',
              950: '#020617'
            }
          },
          fontFamily: {
            sans: ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', '"Segoe UI"', 'Roboto', '"Helvetica Neue"', 'Arial', 'sans-serif'],
            mono: ['JetBrains Mono', 'ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', '"Liberation Mono"', '"Courier New"', 'monospace']
          },
          spacing: {
            '18': '4.5rem',
            '88': '22rem',
            '112': '28rem',
            '128': '32rem'
          },
          borderRadius: {
            'DEFAULT': '0.5rem',
            '4xl': '2rem',
            '5xl': '2.5rem'
          },
          boxShadow: {
            'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
            'glow': '0 0 20px rgb(var(--color-primary-500) / 0.3)',
            'glow-lg': '0 0 40px rgb(var(--color-primary-500) / 0.4)',
            'inner-soft': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.05)'
          },
          animation: {
            'fade-in': 'fadeIn 0.5s ease-in-out',
            'slide-up': 'slideUp 0.3s ease-out',
            'slide-down': 'slideDown 0.3s ease-out',
            'scale-in': 'scaleIn 0.2s ease-out',
            'float': 'float 3s ease-in-out infinite',
            'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
            'shimmer': 'shimmer 2s linear infinite'
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' }
            },
            slideUp: {
              '0%': { transform: 'translateY(10px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' }
            },
            slideDown: {
              '0%': { transform: 'translateY(-10px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' }
            },
            scaleIn: {
              '0%': { transform: 'scale(0.95)', opacity: '0' },
              '100%': { transform: 'scale(1)', opacity: '1' }
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' }
            },
            pulseSoft: {
              '0%, 100%': { opacity: '1' },
              '50%': { opacity: '0.8' }
            },
            shimmer: {
              '0%': { backgroundPosition: '-200% 0' },
              '100%': { backgroundPosition: '200% 0' }
            }
          },
          backdropBlur: {
            xs: '2px'
          }
        }
      },
      plugins: []
    };

    // Enhanced theme initialization
    function initializeEnhancedTheme() {
      try {
        // Set default CSS custom properties for color scheme
        const root = document.documentElement;
        
        // Default purple color scheme
        root.style.setProperty('--color-primary-50', '248 250 252');
        root.style.setProperty('--color-primary-100', '241 245 249');
        root.style.setProperty('--color-primary-200', '226 232 240');
        root.style.setProperty('--color-primary-300', '203 213 225');
        root.style.setProperty('--color-primary-400', '148 163 184');
        root.style.setProperty('--color-primary-500', '139 92 246');
        root.style.setProperty('--color-primary-600', '124 58 237');
        root.style.setProperty('--color-primary-700', '109 40 217');
        root.style.setProperty('--color-primary-800', '91 33 182');
        root.style.setProperty('--color-primary-900', '76 29 149');
        root.style.setProperty('--color-primary-950', '46 16 101');
        
        // Check for saved theme configuration
        const savedConfig = localStorage.getItem('themeConfig');
        if (savedConfig) {
          const config = JSON.parse(savedConfig);
          
          // Apply theme (light/dark/auto)
          if (config.theme === 'dark' || 
              (config.theme === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            root.classList.add('dark');
          }
          
          // Apply color scheme if different from default
          if (config.colorScheme && config.colorScheme !== 'purple') {
            applyColorScheme(config.colorScheme);
          }
          
          // Apply accessibility preferences
          if (config.reducedMotion) {
            root.classList.add('reduce-motion');
          }
          
          if (config.highContrast) {
            root.classList.add('high-contrast');
          }
          
          // Apply font size
          if (config.fontSize) {
            const fontSizes = { small: '14px', medium: '16px', large: '18px' };
            root.style.setProperty('--base-font-size', fontSizes[config.fontSize] || '16px');
          }
        }
        
        // Apply system theme preference if no saved preference
        if (!savedConfig) {
          if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            root.classList.add('dark');
          }
          
          if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            root.classList.add('reduce-motion');
          }
        }
        
      } catch (error) {
        console.warn('Error initializing enhanced theme:', error);
        // Fallback to default theme
        document.documentElement.classList.remove('dark');
      }
    }
    
    function applyColorScheme(scheme) {
      const colorSchemes = {
        blue: {
          500: '59 130 246',
          600: '37 99 235',
          700: '29 78 216'
        },
        green: {
          500: '16 185 129',
          600: '5 150 105',
          700: '4 120 87'
        },
        orange: {
          500: '245 158 11',
          600: '217 119 6',
          700: '180 83 9'
        },
        red: {
          500: '239 68 68',
          600: '220 38 38',
          700: '185 28 28'
        },
        teal: {
          500: '20 184 166',
          600: '13 148 136',
          700: '15 118 110'
        },
        pink: {
          500: '236 72 153',
          600: '219 39 119',
          700: '190 24 93'
        },
        indigo: {
          500: '99 102 241',
          600: '79 70 229',
          700: '67 56 202'
        }
      };
      
      const colors = colorSchemes[scheme];
      if (colors) {
        const root = document.documentElement;
        root.style.setProperty('--color-primary-500', colors[500]);
        root.style.setProperty('--color-primary-600', colors[600]);
        root.style.setProperty('--color-primary-700', colors[700]);
        
        // Update theme color meta tag
        const themeMeta = document.getElementById('theme-color-meta');
        if (themeMeta) {
          themeMeta.content = `rgb(${colors[500]})`;
        }
      }
    }
    
    // Initialize theme as early as possible
    initializeEnhancedTheme();
  </script>
  
  <!-- Enhanced CSS with CSS Custom Properties -->
  <link rel="stylesheet" href="/enhanced_index.css">
  
  <!-- Import Map for Modern ES Modules -->
  <script type="importmap">
  {
    "imports": {
      "@/": "./", 
      "react": "https://esm.sh/react@^19.1.0",
      "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
      "react/": "https://esm.sh/react@^19.1.0/",
      "lucide-react": "https://esm.sh/lucide-react@^0.515.0",
      "localforage": "https://esm.sh/localforage@^1.10.0",
      "react-router-dom": "https://esm.sh/react-router-dom@^7.6.2",
      "@google/genai": "https://esm.sh/@google/genai@0.15.0",
      "chart.js": "https://esm.sh/chart.js@^4.4.2",
      "react-chartjs-2": "https://esm.sh/react-chartjs-2@^5.2.0",
      "lucide": "https://esm.sh/lucide@^0.515.0"
    }
  }
  </script>
  
  <!-- Performance and Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="DENY">
  <meta http-equiv="X-XSS-Protection" content="1; mode=block">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  
  <!-- Preload Critical Resources -->
  <link rel="preload" href="/enhanced_index.css" as="style">
  <link rel="prefetch" href="/index.tsx" as="script">
</head>

<body class="
  h-full 
  bg-white dark:bg-gray-900 
  text-gray-900 dark:text-gray-100
  font-sans antialiased
  transition-colors duration-300
">
  <!-- No Script Message -->
  <noscript>
    <div style="
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: white; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      flex-direction: column;
      font-family: Inter, sans-serif;
    ">
      <h1 style="color: #1f2937; margin-bottom: 1rem;">JavaScript Required</h1>
      <p style="color: #6b7280; text-align: center; max-width: 400px;">
        This application requires JavaScript to run. Please enable JavaScript in your browser settings and reload the page.
      </p>
    </div>
  </noscript>
  
  <!-- Loading Screen -->
  <div id="loading-screen" class="
    fixed inset-0 z-50 
    bg-white dark:bg-gray-900 
    flex items-center justify-center
    transition-opacity duration-300
  ">
    <div class="text-center">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"></div>
      <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">
        Loading Airdrop Compass
      </h2>
      <p class="text-gray-600 dark:text-gray-400">
        Initializing your crypto portfolio...
      </p>
    </div>
  </div>
  
  <!-- Main Application Root -->
  <div id="root" class="h-full"></div>
  
  <!-- React Application Entry Point -->
  <script type="module" src="/index.tsx"></script>
  
  <!-- Enhanced Service Worker Registration -->
  <script>
    // Hide loading screen once app loads
    window.addEventListener('load', () => {
      const loadingScreen = document.getElementById('loading-screen');
      if (loadingScreen) {
        setTimeout(() => {
          loadingScreen.style.opacity = '0';
          setTimeout(() => {
            loadingScreen.remove();
          }, 300);
        }, 500);
      }
    });
    
    // Enhanced Service Worker Registration
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', async () => {
        try {
          const registration = await navigator.serviceWorker.register('/service-worker.js', {
            scope: '/'
          });
          
          console.log('ServiceWorker registration successful:', registration.scope);
          
          // Handle updates
          registration.addEventListener('updatefound', () => {
            const newWorker = registration.installing;
            if (newWorker) {
              newWorker.addEventListener('statechange', () => {
                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                  // New version available
                  if (confirm('A new version is available. Reload to update?')) {
                    window.location.reload();
                  }
                }
              });
            }
          });
          
        } catch (error) {
          console.log('ServiceWorker registration failed:', error);
        }
      });
    }
    
    // Install Prompt Enhancement
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      
      // Show custom install prompt after delay
      setTimeout(() => {
        const event = new CustomEvent('showInstallPrompt', { detail: e });
        window.dispatchEvent(event);
      }, 30000); // Show after 30 seconds
    });
    
    // PWA Install Function
    window.installPWA = async () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        console.log('PWA install outcome:', outcome);
        deferredPrompt = null;
      }
    };
    
    // Performance Monitoring
    window.addEventListener('load', () => {
      if ('performance' in window) {
        const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
        console.log('Page load time:', loadTime, 'ms');
      }
    });
    
    // Error Handling
    window.addEventListener('error', (event) => {
      console.error('Global error:', event.error);
      // In production, you might want to send this to a logging service
    });
    
    window.addEventListener('unhandledrejection', (event) => {
      console.error('Unhandled promise rejection:', event.reason);
      // In production, you might want to send this to a logging service
    });
  </script>
  
  <!-- Analytics (placeholder - replace with your analytics) -->
  <!-- 
  <script>
    // Add your analytics code here
    // Example: Google Analytics, Mixpanel, etc.
  </script>
  -->
</body>
</html>
